- Hadoop RPC的实现中,使用了 [[Java 动态代理]] 和 [[Java NIO]]
- 为什么要有自己的RPC?
- 都用在了什么地方?
- 主要角色和架构是什么样的?
	- Client
		- 包含的主要类
		  collapsed:: true
			- ![image.png](../assets/image_1649667679834_0.png)
		- Client.Connection
			- 表示客户端向服务器建立的一条连接
		- Client.Connection.ConnectionId
			- 目的是为了复用客户端的连接
			- 当服务器地址(address) 用户信息(ticket) 和 协议类型(protocol) 三者一致时,表示可以复用这条连接.
			- 否则,新建Connection 和 ConnectionId
		- Client.Call
			- 客户端调用服务器方法时的代码抽象,具体的创建流程如下
				- 所有的RPC方法都被`java.lang.reflect.InvocationHandler` 捕获,并调用具体的`Invoker` 的`invoke()`方法,有两类
					- org.apache.hadoop.ipc.WritableRpcEngine.Invoker
					- org.apache.hadoop.ipc.ProtobufRpcEngine.Invoker
				- invoke方法中会调用 Client.call(),主要做了如下事情
					- Client.createCall() 创建了一个Call对象
					- Client.getConnection() 获取到一个Connection
					- ` connection.sendRpcRequest(call)` 发送报文
					- 异步等待结果返回
			-
	- Server
		- 包含的主要类 
		  collapsed:: true
			- ![image.png](../assets/image_1649667716473_0.png)
			-
	- RPC
		- 包含的主要类
		  collapsed:: true
			- ![image.png](../assets/image_1649667735794_0.png)
			-
-
- RPC流程是什么样的?
-
- 相关类定位
	- org.apache.hadoop.ipc.Client
	- org.apache.hadoop.ipc.Server
	- org.apache.hadoop.ipc.RPC