- 恢复算法是一种技术，用来在失败时，确保数据库的一致性、事务的原子性和持久性
- 恢复算法分为两大部分：
	- 发生在事务期间的，用以确保DBMS可从失败中复原。
	- 发生在故障之后进行恢复，确保数据库的状态符合原子性、一致性和持久性
- 故障的级别 Failure Classification
	- DBMS的不同组件依赖于不同的存储设备，而存储设备有如下三类
		- Volatile Storage
		  collapsed:: true
			- 当断电或程序退出后，数据不会留存
			- 如：各种内存、DRAM、SRAM
		- Non-volatile Storage
		  id:: 6677cbcc-b335-4e44-b96b-ac0c9cac7ffd
			- 当断电或程序退出后，数据依旧存在
			- 如：各种硬盘 HDD、SDD
		- Stable Storage
		  collapsed:: true
			- 永远不会坏的Non-volatile Storage
- DBMS中的故障分为三级
	- 事务级别的故障 Transaction Failures
		- 逻辑错误 Logical Errors
			- 由于一些程序允许的错误原因，导致事务无法完成
			- 如：用户要求回滚或者OCC的校验阶段发现不可串行而被迫回滚
		- 内部状态错误 Internal State Errors
			- 由于某个错误条件，DBMS必须中止并且重新执行transaction
			- 如：两个事务之间构成死锁，不得不把其中一个回滚
	- 系统级别的故障 System Failures
		- 软件异常 Software Failures
			- DBMS或者OS的bug
		- 硬件异常 Hardware Failures
			- 运行DBMS的机器崩溃了。如：断电
			- Fail-stop假说： ((6677cbcc-b335-4e44-b96b-ac0c9cac7ffd))   硬盘引起的故障不包括在系统故障中。
	- 存储媒介的故障 Storage Media Failures
		- 这类故障一般是无法修复的，数据库开发者无需考虑这些
- Undo和Redo 操作
	- Undo: 移除未完成或者abort 事务的影响。
	- Redo：恢复已commit事务，保证其持久性。
	- DBMS如何支持这两个操作，取决于她如何管理缓存池buffer pool
- DBMS要求**事务在commit的时候必须把它所做的更新写入磁盘**,是为Force策略；否则，是No-Force策略
- No-Steal+Force策略
	- ![image.png](../assets/image_1719128535452_0.png){:height 249, :width 478}
	- No-Steal：修改时都会copy一份
	- Force:commit时必须把修改写入磁盘
	-